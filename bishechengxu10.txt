package com.entity;

public class Deckchukudata {
	private String cktime;
	private String ckperson;
	private String deno;
	private String amount;
	private String dename;
	
	public Deckchukudata(String cktime,String ckperson,String deno,String amount,String dename){
		super();
		this.cktime=cktime;
		this.ckperson=ckperson;
		this.deno=deno;
		this.amount=amount;
		this.dename=dename;
	}
	
	public Deckchukudata(){
		super();
	}

	public String getCktime() {
		return cktime;
	}

	public void setCktime(String cktime) {
		this.cktime = cktime;
	}

	public String getCkperson() {
		return ckperson;
	}

	public void setCkperson(String ckperson) {
		this.ckperson = ckperson;
	}

	public String getDeno() {
		return deno;
	}

	public void setDeno(String deno) {
		this.deno = deno;
	}

	public String getAmount() {
		return amount;
	}

	public void setAmount(String amount) {
		this.amount = amount;
	}

	public String getDename() {
		return dename;
	}

	public void setDename(String dename) {
		this.dename = dename;
	}

	@Override
	public String toString() {
		return "deck_view_chuku [cktime=" + cktime + ", ckperson=" + ckperson
				+ ", deno=" + deno + ", amount=" + amount + ", dename="
				+ dename + "]";
	}

}

package com.dao.show;

import java.sql.SQLException;
import java.util.List;

import org.apache.commons.dbutils.QueryRunner;
import org.apache.commons.dbutils.handlers.BeanListHandler;

import com.entity.Deckchukudata;

import com.util.JdbcUtil;

public class ShowDeckchukuDaoImpl implements ShowDeckchukuDao {

	public List<Deckchukudata> showData(String tablename) {
		try {
			QueryRunner qr = new QueryRunner(JdbcUtil.getDataSource());
			String sql = "SELECT * FROM "+tablename+" ";
			return (List<Deckchukudata>)qr.query(sql, new BeanListHandler(Deckchukudata.class));
		} catch (SQLException e) {
			e.printStackTrace();
			throw new RuntimeException(e);
		}
	}

}

package com.dao.show;

import java.sql.SQLException;
import java.util.List;

import org.apache.commons.dbutils.QueryRunner;
import org.apache.commons.dbutils.handlers.BeanListHandler;

import com.entity.Deckchukudata;

import com.util.JdbcUtil;

public class ShowDeckchukuDaoImpl implements ShowDeckchukuDao {

	public List<Deckchukudata> showData(String tablename) {
		try {
			QueryRunner qr = new QueryRunner(JdbcUtil.getDataSource());
			String sql = "SELECT * FROM "+tablename+" ";
			return (List<Deckchukudata>)qr.query(sql, new BeanListHandler(Deckchukudata.class));
		} catch (SQLException e) {
			e.printStackTrace();
			throw new RuntimeException(e);
		}
	}

}

package com.service.show;

import java.util.List;

import com.dao.show.ShowDeckchukuDao;
import com.dao.show.ShowDeckchukuDaoImpl;
import com.entity.Deckchukudata;


public class ShowDeckchukuServiceImpl implements ShowDeckchukuService {

	ShowDeckchukuDao dao = new ShowDeckchukuDaoImpl();
	public List<Deckchukudata> showData(String tablename) {	
		System.out.println(dao.showData(tablename));
		return dao.showData(tablename);
	}
}


package com.web.show;

import java.io.IOException;
import java.util.List;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import com.entity.Deckchukudata;
import com.entity.Deckrukudata;
import com.service.show.ShowDeckchukuService;
import com.service.show.ShowDeckchukuServiceImpl;
import com.service.show.ShowDeckrukuService;
import com.service.show.ShowDeckrukuServiceImpl;

public class ShowDeckchukuServlet extends HttpServlet {
	public void doGet(HttpServletRequest request, HttpServletResponse response)
			throws ServletException, IOException {

		request.setCharacterEncoding("utf-8");
		// 数据封装
	
		
		//将用户输入的数据封装到aquery
		//aquery = WebUtil.copyRequestToBean(request, AdminQuery.class);
		// 请求头用于防止非法链接
		String referer = request.getHeader("referer");
		String tablename = request.getParameter("tablename");
		
		// 获取用输入的数据
		String currentPage = request.getParameter("currentPage");
		if (currentPage == null || currentPage.equals("")) {
			// 如果用户第一次访问，没有传递currentPage参数，则当前页为1
			currentPage = "1";
		}

		String pageSize = request.getParameter("pageSize");
		if (pageSize == null || pageSize.equals("")) {
			pageSize = "5";
		}
		ShowDeckchukuService service = new ShowDeckchukuServiceImpl();
		List<Deckchukudata> declist = service.showData(tablename);
		System.out.println(declist);
		//request.setAttribute("pageBean", pageBean);
		request.setAttribute("declist", declist);
		request.getRequestDispatcher("/jsp/deckchuku.jsp").forward(request, response);	

			
	}

	public void doPost(HttpServletRequest request, HttpServletResponse response)
			throws ServletException, IOException {
		doGet(request, response);

	}


}

